{"version":3,"file":"main.js","mappings":";;;;;;;;;AAAA,eAAe,GAAG,IAAiD,oBAAoB,KAAK,aAAiI,CAAC,iBAAiB,aAAa,SAAS,UAAU,+DAA+D,uBAAuB,EAAE,0DAA0D,4FAA4F,eAAe,wCAAwC,SAAS,GAAG,MAAM,cAAc,+DAA+D,cAAc,4CAA4C,SAAS,GAAG,QAAQ,eAAe,uGAAuG,4DAA4D,oDAAoD,GAAG,qDAAqD,EAAE,kEAAkE,EAAE,GAAG,2CAA2C,gCAAgC,sBAAsB,8HAA8H,GAAG,mEAAmE,2CAA2C,oEAAoE,6FAA6F,kJAAkJ,GAAG,GAAG,mDAAmD,sCAAsC,sBAAsB,gFAAgF,6BAA6B,6BAA6B,6HAA6H,sBAAsB,gCAAgC,EAAE,SAAS,0CAA0C,0BAA0B,8BAA8B,KAAK,KAAK,2BAA2B,mIAAmI,SAAS,2BAA2B,4BAA4B,sLAAsL,EAAE,wBAAwB,WAAW,GAAG,0BAA0B,6DAA6D,iDAAiD,qHAAqH,oCAAoC,mCAAmC,EAAE,cAAc,gBAAgB,EAAE,YAAY,GAAG,YAAY,+BAA+B,mHAAmH,kCAAkC,uBAAuB,uEAAuE,8FAA8F,GAAG,yBAAyB,MAAM,aAAa,+GAA+G,8CAA8C,6OAA6O,gFAAgF,kCAAkC,yBAAyB,wCAAwC,cAAc,yDAAyD,sCAAsC,gDAAgD,uDAAuD,oCAAoC,+BAA+B,iCAAiC,YAAY,wBAAwB,uMAAuM,+BAA+B,mCAAmC,wBAAwB,kIAAkI,6BAA6B,YAAY,wBAAwB,yDAAyD,mCAAmC,iCAAiC,+IAA+I,4BAA4B,cAAc,6EAA6E,MAAM,gFAAgF,MAAM,8EAA8E,MAAM,kDAAkD,MAAM,gDAAgD,MAAM,+EAA+E,MAAM,mCAAmC,0BAA0B,MAAM,iCAAiC,KAAK,0DAA0D,uEAAuE,0CAA0C,oCAAoC,UAAU,wJAAwJ,2FAA2F,wEAAwE,8CAA8C,mBAAmB,qCAAqC,QAAQ,gTAAgT,8BAA8B,8EAA8E,EAAE,GAAG,aAAa,qBAAqB,qFAAqF,kGAAkG,QAAQ,eAAe,yCAAyC,MAAM,oEAAoE,gDAAgD,gEAAgE,uEAAuE,8FAA8F,sBAAsB,sJAAsJ,gGAAgG,yFAAyF,sDAAsD,QAAQ,QAAQ,WAAW,6CAA6C,QAAQ,WAAW,qDAAqD,QAAQ,WAAW,2DAA2D,kCAAkC,qBAAqB,GAAG,WAAW,oCAAoC,WAAW,GAAG,EAAE,SAAS,uBAAuB,cAAc,yBAAyB,WAAW,IAAI,GAAG,EAAE,SAAS,uBAAuB,aAAa,yBAAyB,UAAU,EAAE,mBAAmB,uBAAuB,wEAAwE,0DAA0D,sFAAsF,mCAAmC,4BAA4B,wFAAwF,mCAAmC,uBAAuB,iFAAiF,yCAAyC,0FAA0F,WAAW,gDAAgD,wBAAwB,KAAK,2BAA2B,WAAW,YAAY,4BAA4B,0EAA0E,SAAS,8BAA8B,uDAAuD,uEAAuE,+CAA+C,6BAA6B,uEAAuE,8FAA8F,mTAAmT,mCAAmC,sBAAsB,4CAA4C,wBAAwB,KAAK,gBAAgB,YAAY,4BAA4B,8EAA8E,6CAA6C,SAAS;;;;;;;;;;;;;;;ACQpoU,SAAS,MAAM,CAAC,KAAqB;IACnC,OAAQ,KAAuB,CAAC,IAAI,KAAK,SAAS,CAAC;AACrD,CAAC;AAED,SAAS,WAAW,CAAC,KAAqB;IACxC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;AACxB,CAAC;AAcD,MAAM,8BAA8B,GAAG,CACrC,UAAkB,EAClB,aAAqB,EACrB,EAAE;AAcJ,CAAC,CAAC;AAEK,MAAM,YAAY;IAIvB,YAAY,IAAiB;QAK7B,eAAU,GAAe,GAAG,EAAE;YAC5B,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC9B,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC5B,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAC3B,CAAC,CAAC;QAEF,sBAAiB,GAAe,GAAG,EAAE;YACnC,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,MAAM,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;QAElE,CAAC,CAAC;QAEF,2BAAsB,GAAe,GAAG,EAAE;YACxC,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE;gBAChD,EAAE,CAAC,cAAc,EAAE,CAAC;gBACpB,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,mCAAmC,CAAC,CAAC;YACnE,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,GAAG,EAAE;gBAC/C,IAAI,CAAC,cAAc,EAAE,CAAC;YACxB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,yBAAoB,GAAe,GAAG,EAAE;YACtC,MAAM,kBAAkB,GAAqB,IAAI,CAAC,aAAa,CAAC,MAAO,CAAC,CAAC,CAAC,CAAC;YAC3E,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,OAAO,EAAE,GAAG,EAAE;gBAChD,kBAAkB,CAAC,SAAS,CAAC,GAAG,CAAC,kCAAkC,CAAC,CAAC;YACvE,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,MAAM,EAAE,GAAG,EAAE;gBAC/C,kBAAkB,CAAC,SAAS,CAAC,MAAM,CAAC,kCAAkC,CAAC,CAAC;YAC1E,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,mBAAc,GAAe,GAAG,EAAE;YAChC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,mCAAmC,CAAC,CAAC;QACtE,CAAC,CAAC;QASF,uBAAkB,GAAoC,KAAK,EAAE,EAAE,EAAE,EAAE;;YACjE,EAAE,CAAC,cAAc,EAAE,CAAC;YACpB,MAAM,KAAK,GAAyB,QAAE,CAAC,YAAY,0CAAE,KAAM,CAAC;YAE5D,MAAM,WAAW,GAA4B,KAAK,CAAC,CAAC,CAAC,CAAC;YACtD,MAAM,WAAW,GAAG,WAAW,CAAC,gBAAgB,EAAE,CAAC;YAEnD,MAAM,eAAe,GAAyB,MAAM,IAAI,CAAC,WAAW,CAClE,WAAsC,EACtC,EAAE,CACH,CAAC;YAEF,8BAA8B,CAC5B,WAAY,CAAC,IAAI,EACjB,eAAe,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAChD,CAAC;QAcJ,CAAC,CAAC;QAEF,kBAAa,GAAiD,CAAC,MAAM,EAAE,EAAE;YACvE,OAAO,IAAI,OAAO,CAAiB,CAAC,OAAO,EAAE,EAAE;gBAC7C,MAAM,CAAC,WAAW,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;YACpD,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,qBAAgB,GAAoD,CAClE,KAAK,EACL,EAAE;YACF,OAAO,IAAI,OAAO,CAAgB,CAAC,OAAO,EAAE,EAAE;gBAC5C,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE,CAClB,OAAO,CAAC;oBACN,IAAI;oBACJ,IAAI,EAAE,KAAK,CAAC,QAAQ;iBACrB,CAAC,CACH,CAAC;YACJ,CAAC,CAAC,CAAC;QACL,CAAC,CAAC;QAEF,yBAAoB,GAAiD,KAAK,EACxE,MAAM,EACN,EAAE;YACF,IAAI,UAAU,GAAmB,EAAE,CAAC;YAEpC,IAAI,SAAS,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YAEjD,OAAO,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC3B,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;gBAC1C,SAAS,GAAG,MAAM,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;aAC9C;YAED,OAAO,UAAU,CAAC;QACpB,CAAC,CAAC;QAEF,gBAAW,GAGsB,KAAK,EAAE,KAAK,EAAE,aAAa,EAAE,EAAE;YAC9D,MAAM,MAAM,GAAY,KAAM,CAAC,YAAY,EAAE,CAAC;YAC9C,MAAM,OAAO,GAAmB,MAAM,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC;YACxE,IAAI,KAAM,CAAC,WAAW,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC9C,aAAa,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,KAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;aAC/C;YACD,KAAK,MAAM,KAAK,IAAI,OAAO,EAAE;gBAC3B,IAAI,KAAK,CAAC,WAAW,EAAE;oBACrB,MAAM,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;iBAC9C;qBAAM;oBACL,MAAM,IAAI,GAAkB,MAAM,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;oBAC/D,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBAC1B;aACF;YACD,OAAO,aAAa,CAAC;QACvB,CAAC,CAAC;QAnIA,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,yBAAyB,CAAE,CAAC;QACpE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,wBAAwB,CAAE,CAAC;IAChE,CAAC;IAuCO,mBAAmB,CAAC,MAAwB;QAClD,MAAM,SAAS,GAAmB,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACrE,MAAM,YAAY,GAAW,SAAS,CAAC,IAAI,CAAC;QAC5C,MAAM,SAAS,GAAa,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACpD,OAAO,SAAS,CAAC,CAAC,CAAC,CAAC;IACtB,CAAC;CAsFF;;;;;;;UCxLD;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;ACNqE;AACU;AAChC;AAE/C,MAAM,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,CAAC,KAAK,EAAE,EAAE;IAIpD,MAAM,YAAY,GAAG,QAAQ,CAAC,gBAAgB,CAC5C,mCAAmC,CACpC,CAAC;IAEF,YAAY,CAAC,OAAO,CAAC,CAAC,EAAE,EAAE,EAAE;QAC1B,MAAM,iBAAiB,GAAG,IAAI,+EAAiB,CAAC,EAAiB,CAAC,CAAC;QACnE,iBAAiB,CAAC,UAAU,EAAE,CAAC;IACjC,CAAC,CAAC,CAAC;IAKH,MAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;IACnD,IAAI,IAAI,IAAI,IAAI,EAAE;QAChB,MAAM,gBAAgB,GAAG,IAAI,8EAAgB,CAAC,IAAwB,CAAC,CAAC;QACxE,gBAAgB,CAAC,uBAAuB,CAAC,8EAAgB,CAAC,CAAC;KAC5D;IAED,MAAM,YAAY,GAAgB,QAAQ,CAAC,aAAa,CACtD,iCAAiC,CAClC,CAAC;IACF,IAAI,YAAY,EAAE;QAChB,MAAM,EAAE,GAAiB,IAAI,wDAAY,CAAC,YAAY,CAAC,CAAC;QACxD,EAAE,CAAC,UAAU,EAAE,CAAC;KACjB;AACH,CAAC,CAAC,CAAC","sources":["webpack://govuk-prototype-kit/./node_modules/@nationalarchives/tdr-components/dist/index.js","webpack://govuk-prototype-kit/./app/assets/typescript/folder-upload.ts","webpack://govuk-prototype-kit/webpack/bootstrap","webpack://govuk-prototype-kit/webpack/runtime/compat get default export","webpack://govuk-prototype-kit/webpack/runtime/define property getters","webpack://govuk-prototype-kit/webpack/runtime/hasOwnProperty shorthand","webpack://govuk-prototype-kit/webpack/runtime/make namespace object","webpack://govuk-prototype-kit/./app/assets/typescript/main.ts"],"sourcesContent":["!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var s=t();for(var i in s)(\"object\"==typeof exports?exports:e)[i]=s[i]}}(self,(()=>(()=>{\"use strict\";var e,t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})}},s={};t.r(s),t.d(s,{InputType:()=>e,MultiSelectSearch:()=>r,NestedNavigation:()=>i}),function(e){e.radios=\"radios\",e.checkboxes=\"checkboxes\"}(e||(e={}));class i{constructor(t){this.getCurrentFocus=()=>this.currentFocus,this.getTree=()=>this.tree,this.initialiseFormListeners=t=>{null!==this.tree&&this.tree.addEventListener(\"keydown\",(e=>{e instanceof KeyboardEvent&&this.handleKeyDown(e,t)}));const s=Array.from(this.tree.querySelectorAll(`.js-${t}-directory`)),i=this.tree.querySelectorAll(`.js-tree__expander--${t}`);[...s,...Array.from(i)].forEach(((e,s,i)=>{e.addEventListener(\"click\",(e=>{let s=e.currentTarget;!1===s.id.includes(\"expander\")&&(s=s.previousElementSibling),this.handleExpanders(s,t),e.preventDefault(),e.stopPropagation()}))})),this.tree.querySelectorAll('[role=\"group\"]').forEach(((e,s,i)=>{e.id.includes(t)&&this.updateExpanded(e,t)})),this.tree.querySelectorAll(\"[role=treeitem]\").forEach(((s,i,r)=>{t==e.radios&&!0===s.id.includes(\"folder\")||s.id.includes(t)&&s.addEventListener(\"click\",(e=>{e.currentTarget instanceof HTMLLIElement&&(this.setSelected(e.currentTarget,t),this.setFocusToItem(e.currentTarget)),e.stopImmediatePropagation()}))}));const r=this.tree.querySelector(\"[role=treeitem]\");r&&(r.tabIndex=0,this.currentFocus=r)},this.updateFocus=e=>{null!=e?this.setFocusToItem(e):this.setFocusToItem(this.tree.firstElementChild)},this.updateExpanded=(e,t)=>{const s=e.getAttribute(\"id\");null!==s&&(this.getExpanded(t).includes(s.replace(\"node-group\",\"list\"))||e.parentNode.setAttribute(\"aria-expanded\",\"false\"))},this.getExpanded=e=>{const t=localStorage.getItem(`${e}-state`);return null!==t?JSON.parse(t).expanded:[]},this.allChildren=(e,t)=>{for(let s=e.children.length-1;s>=0;s--){const i=e.children.item(s);null!==i&&(\"LI\"===i.nodeName&&t.push(i),Array.from(i.children).filter((e=>\"UL\"===e.nodeName)).forEach((e=>this.allChildren(e,t))))}return t},this.toggleNode=(e,t,s)=>{const i=this.getExpanded(s);\"false\"===e.getAttribute(\"aria-expanded\")?(e.setAttribute(\"aria-expanded\",\"true\"),i.push(t)):(e.setAttribute(\"aria-expanded\",\"false\"),i.splice(i.indexOf(t))),localStorage.setItem(`${s}-state`,JSON.stringify({expanded:i}))},this.setSelected=(t,s)=>{if(null==t||t.id.includes(\"folder\")&&s==e.radios)return null;const i=\"true\"===t.getAttribute(\"aria-selected\");if(t.setAttribute(\"aria-selected\",i?\"false\":\"true\"),t.setAttribute(\"aria-checked\",i?\"false\":\"true\"),s!==e.radios||i){if(t.hasAttribute(\"aria-expanded\")){const e=document.querySelector(`#${s}-node-group-${t.id.replace(`${s}-list-`,\"\")}`);if(null!=e){const t=this.allChildren(e,[]);for(const e of t)e.setAttribute(\"aria-selected\",i?\"false\":\"true\"),e.setAttribute(\"aria-checked\",i?\"false\":\"true\")}}const e=t.closest(\"[role=group]\");this.setParentState(e)}else this.tree.querySelectorAll(\"li[aria-selected=true]\").forEach((e=>{e.id!==t.id&&(e.setAttribute(\"aria-selected\",\"false\"),e.setAttribute(\"aria-checked\",\"false\"))}))},this.setParentState=e=>{var t;if(null!==e){const s=this.allChildren(e,[]),i=s.filter((e=>\"true\"===e.getAttribute(\"aria-selected\"))).length,r=e.parentNode;if(null!==r&&\"tree\"!==e.getAttribute(\"role\")){i>0&&i<s.length&&r.setAttribute(\"aria-checked\",\"mixed\"),i===s.length&&(r.setAttribute(\"aria-checked\",\"true\"),r.setAttribute(\"aria-selected\",\"true\")),0===i&&(r.setAttribute(\"aria-selected\",\"false\"),r.setAttribute(\"aria-checked\",\"false\"));const l=null===(t=e.parentElement)||void 0===t?void 0:t.closest(\"[role=group]\");null!=l&&this.setParentState(l)}}},this.setFocusToItem=e=>{Array.from(this.treeItems).forEach((e=>{e.tabIndex=-1})),null!=e&&(e.tabIndex=0,e.focus(),this.currentFocus=e)},this.setFocusToLastExpandedChild=e=>{if(e&&\"true\"===e.getAttribute(\"aria-expanded\")){const t=e.querySelector(\":scope > ul > li:last-child\");this.setFocusToLastExpandedChild(t)}else e&&this.setFocusToItem(e)},this.setFocusToPreviousItem=e=>{if(null!=e){const t=e.closest(\"li\");null!=(null==t?void 0:t.previousElementSibling)?this.setFocusToLastExpandedChild(t.previousElementSibling):null!=(null==t?void 0:t.parentElement)&&this.setFocusToItem(t.parentElement.closest(\"li\"))}},this.setFocusToNextParent=e=>{if(\"tree\"!=e.getAttribute(\"role\")){const t=e.closest(\"li\");null!=(null==t?void 0:t.nextElementSibling)?this.setFocusToItem(t.nextElementSibling):this.setFocusToNextParent(t.parentElement)}},this.setFocusToNextItem=e=>{if(null!=e){const t=e.closest(\"li\");if(null!==t)if(\"true\"===t.getAttribute(\"aria-expanded\")){const e=t.querySelector(\"ul > li\");null!==e&&this.setFocusToItem(e)}else null!==t.nextElementSibling?this.setFocusToItem(t.nextElementSibling):null!==t.parentElement&&this.setFocusToNextParent(t.parentElement)}},this.handleKeyDown=(e,t)=>{switch(e.key){case\"Enter\":case\" \":this.setSelected(this.currentFocus,t),e.preventDefault();break;case\"ArrowUp\":this.setFocusToPreviousItem(this.currentFocus),e.preventDefault();break;case\"ArrowDown\":this.setFocusToNextItem(this.currentFocus),e.preventDefault();break;case\"ArrowRight\":this.processArrowRightEvent(e,t);break;case\"ArrowLeft\":this.processArrowLeftEvent(e,t);break;case\"Home\":this.setFocusToItem(this.tree.firstElementChild),e.preventDefault();break;case\"End\":this.processEndEvent(e)}},this.processEndEvent=e=>{var t;let s=this.tree.lastElementChild;for(;\"true\"===(null==s?void 0:s.getAttribute(\"aria-expanded\"));)s=null===(t=s.lastElementChild)||void 0===t?void 0:t.lastElementChild;this.setFocusToItem(s),e.preventDefault()},this.processArrowLeftEvent=(e,t)=>{var s,i,r;if(\"true\"===(null===(s=this.currentFocus)||void 0===s?void 0:s.getAttribute(\"aria-expanded\")))this.toggleNode(this.currentFocus,this.currentFocus.id,t);else if(\"tree\"!==(null===(i=this.currentFocus)||void 0===i?void 0:i.getAttribute(\"role\"))){const e=null===(r=this.currentFocus)||void 0===r?void 0:r.parentElement;null!=e&&this.setFocusToItem(e.closest(\"li\"))}e.preventDefault()},this.processArrowRightEvent=(e,t)=>{var s,i;\"false\"===(null===(s=this.currentFocus)||void 0===s?void 0:s.getAttribute(\"aria-expanded\"))?this.toggleNode(this.currentFocus,this.currentFocus.id,t):\"true\"===(null===(i=this.currentFocus)||void 0===i?void 0:i.getAttribute(\"aria-expanded\"))&&this.setFocusToNextItem(this.currentFocus),e.preventDefault()},this.handleExpanders=(e,t)=>{const s=e.id.replace(\"expander-\",\"node-group-\"),i=this.tree.querySelector(`#${s}`);if(null!==i){const s=i.parentNode;null!=s&&(this.toggleNode(s,e.id.replace(\"expander-\",\"\"),t),this.setFocusToItem(s))}},this.tree=t,this.treeItems=this.tree.querySelectorAll(\"[role=treeitem]\"),this.currentFocus=null}}class r{constructor(e){this.timeoutId=null,this.initialise=()=>{var e;null===(e=this.filter)||void 0===e||e.addEventListener(\"keyup\",(e=>{e instanceof KeyboardEvent&&this.handleKeyUp(e)})),this.list.addEventListener(\"change\",this.processInputChange);const t=this.getSelectedItems().length,s=this.getVisibleItems().length;this.updateSelectedCount(this.selectedCount,t),this.updateFilteredCount(this.filterCount,t,s)},this.handleKeyUp=e=>{e.stopPropagation(),\"Enter\"!==e.key?(clearTimeout(Number(this.timeoutId)),this.timeoutId=setTimeout(this.processKeyUpTimeout,300)):e.preventDefault()},this.cleanString=e=>(e=(e=(e=e.replace(/&/g,\"and\")).replace(/[’',:–-]/g,\"\")).replace(/[.*+?^${}()|[\\]\\\\]/g,\"\\\\$&\")).trim().replace(/\\s\\s+/g,\" \").toLowerCase(),this.filterItems=(e,t)=>{const s=this.cleanString(e),i=this.getSelectedItems();let r=0;for(r=0;r<t.length;r++)-1!==this.labels[r].search(s)&&i.push(r);for(r=0;r<t.length;r++)this.list.children[r].classList.add(\"is-hidden\");for(r=0;r<i.length;r++)this.list.children[i[r]].classList.remove(\"is-hidden\")},this.updateSelectedCount=(e,t)=>{e&&(e.textContent=`${t} selected`)},this.updateFilteredCount=(e,t,s)=>{const i=`${s} ${1===s?`${this.config.copySingle}displayed`:`${this.config.copyMultiple}displayed`}, ${t} ${1===t?`${this.config.copySingle}selected`:`${this.config.copyMultiple}selected`}`;e&&(e.innerHTML=i)},this.setupHeight=()=>{const e=this.container.clientHeight,t=this.getAbsoluteHeight(this.list);if(t<e+50)return void(this.container.style.height=t+\"px\");const s=this.getInViewport(this.list.children).pop(),i=s.offsetTop+s.clientHeight/1.5;this.container.style.height=i+\"px\"},this.getAbsoluteHeight=e=>{const t=window.getComputedStyle(e),s=parseFloat(t.marginTop)+parseFloat(t.marginBottom);return Math.ceil(e.offsetHeight+s)},this.isInViewport=e=>{const t=this.container.clientHeight,s=this.container.getBoundingClientRect().top;return e.getBoundingClientRect().top-s<t},this.getInViewport=e=>Array.from(e).filter(this.isInViewport),this.getSelectedItems=()=>{const e=[];return Array.from(this.inputs).forEach(((t,s)=>{1==t.checked&&e.push(s)})),e},this.getVisibleItems=()=>{const e=[];for(let t=0;t<this.list.children.length;t++)!1===this.list.children[t].classList.contains(\"is-hidden\")&&e.push(t);return e},this.processKeyUpTimeout=e=>{this.filterItems(this.filter.value,this.list.children);const t=this.getSelectedItems().length,s=this.getVisibleItems().length;this.updateFilteredCount(this.filterCount,t,s)},this.processInputChange=e=>{const t=this.getSelectedItems().length,s=this.getVisibleItems().length;this.updateSelectedCount(this.selectedCount,t),this.updateFilteredCount(this.filterCount,t,s)},this.container=e.querySelector(\".js-container\"),this.list=e.querySelector(\"ul\"),this.inputs=e.querySelectorAll(\"input[type=checkbox]\"),this.filter=e.querySelector(\"input[type=text]\"),this.filterCount=e.querySelector(\".js-filter-count\"),this.selectedCount=e.querySelector(\".js-selected-count\"),this.config={copySingle:e.dataset.copySingle?`${e.dataset.copySingle} `:\"\",copyMultiple:e.dataset.copyMultiple?`${e.dataset.copyMultiple} `:\"\"},this.labels=[];for(let e=0;e<this.list.children.length;e++)this.labels.push(this.cleanString(this.list.children[e].textContent||\"\"));e.setAttribute(\"data-module-active\",\"true\")}}return s})()));","interface IFileWithPath {\n  file: File;\n  path: string;\n}\n\ntype IEntryWithPath = IFileWithPath | IDirectoryWithPath;\ntype IDirectoryWithPath = Pick<IFileWithPath, \"path\">;\n\nfunction isFile(entry: IEntryWithPath): entry is IFileWithPath {\n  return (entry as IFileWithPath).file !== undefined;\n}\n\nfunction isDirectory(entry: IEntryWithPath): entry is IFileWithPath {\n  return !isFile(entry);\n}\ninterface IReader {\n  readEntries: (callbackFunction: (entry: IWebkitEntry[]) => void) => void;\n}\n\ninterface IWebkitEntry extends DataTransferItem {\n  createReader: () => IReader;\n  isFile: boolean;\n  isDirectory: boolean;\n  fullPath: string;\n  name?: string;\n  file: (success: (file: File) => void) => void;\n}\n\nconst displaySelectionSuccessMessage = (\n  folderName: string,\n  numberOfFiles: number\n) => {\n  // const selectionArea = document.querySelector(\"#selection-area\");\n  // const successMessageContainer: HTMLElement | null = document.querySelector(\n  //   \"#item-selection-success-container\"\n  // );\n  // selectionArea?.classList.remove(\"govuk-form-group--error\");\n  // Object.values(warningMessagesToHide).forEach(\n  //   (warningMessageElement: HTMLElement | null) => {\n  //     warningMessageElement?.setAttribute(\"hidden\", \"true\");\n  //   }\n  // );\n  // successMessageContainer?.removeAttribute(\"hidden\");\n  // successMessage?.removeAttribute(\"hidden\");\n  // successMessage?.focus();\n};\n\nexport class FolderUpload {\n  private readonly dropzone: HTMLElement;\n  private readonly itemRetriever: HTMLInputElement;\n\n  constructor(root: HTMLElement) {\n    this.itemRetriever = root.querySelector(\".js-drag-and-drop-input\")!;\n    this.dropzone = root.querySelector(\".js-drag-and-drop-zone\")!;\n  }\n\n  initialise: () => void = () => {\n    this.addDropzoneHighlighter();\n    this.addButtonHighlighter();\n    this.addFolderListener();\n  };\n\n  addFolderListener: () => void = () => {\n    this.dropzone.addEventListener(\"drop\", this.handleDroppedItems);\n    // this.itemRetriever.addEventListener(\"change\", this.handleSelectedItems);\n  };\n\n  addDropzoneHighlighter: () => void = () => {\n    this.dropzone.addEventListener(\"dragover\", (ev) => {\n      ev.preventDefault();\n      this.dropzone.classList.add(\"drag-and-drop__dropzone--dragover\");\n    });\n\n    this.dropzone.addEventListener(\"dragleave\", () => {\n      this.removeDragover();\n    });\n  };\n\n  addButtonHighlighter: () => void = () => {\n    const itemRetrieverLabel: HTMLLabelElement = this.itemRetriever.labels![0];\n    this.itemRetriever.addEventListener(\"focus\", () => {\n      itemRetrieverLabel.classList.add(\"drag-and-drop__button--highlight\");\n    });\n\n    this.itemRetriever.addEventListener(\"blur\", () => {\n      itemRetrieverLabel.classList.remove(\"drag-and-drop__button--highlight\");\n    });\n  };\n\n  removeDragover: () => void = () => {\n    this.dropzone.classList.remove(\"drag-and-drop__dropzone--dragover\");\n  };\n\n  private getParentFolderName(folder: IEntryWithPath[]) {\n    const firstItem: IEntryWithPath = folder.filter((f) => isFile(f))[0];\n    const relativePath: string = firstItem.path;\n    const splitPath: string[] = relativePath.split(\"/\");\n    return splitPath[0];\n  }\n\n  handleDroppedItems: (ev: DragEvent) => Promise<any> = async (ev) => {\n    ev.preventDefault();\n    const items: DataTransferItemList = ev.dataTransfer?.items!;\n\n    const droppedItem: DataTransferItem | null = items[0];\n    const webkitEntry = droppedItem.webkitGetAsEntry();\n\n    const filesAndFolders: IDirectoryWithPath[] = await this.getAllFiles(\n      webkitEntry as unknown as IWebkitEntry,\n      []\n    );\n\n    displaySelectionSuccessMessage(\n      webkitEntry!.name,\n      filesAndFolders.filter((f) => isFile(f)).length\n    );\n    // const files = filesAndFolders.filter((f) =>\n    //   isFile(f)\n    // ) as IFileWithPath[];\n    // const folderCheck = this.checkIfFolderHasFiles(files);\n    // if (!isError(folderCheck)) {\n    //   this.selectedFiles = filesAndFolders;\n    //   addFolderSelectionSuccessMessage(\n    //     webkitEntry!.name,\n    //     this.selectedFiles.filter((f) => isFile(f)).length\n    //   );\n    // } else {\n    //   return folderCheck;\n    // }\n  };\n\n  getEntryBatch: (reader: IReader) => Promise<IWebkitEntry[]> = (reader) => {\n    return new Promise<IWebkitEntry[]>((resolve) => {\n      reader.readEntries((entries) => resolve(entries));\n    });\n  };\n\n  getFileFromEntry: (entry: IWebkitEntry) => Promise<IFileWithPath> = (\n    entry\n  ) => {\n    return new Promise<IFileWithPath>((resolve) => {\n      entry.file((file) =>\n        resolve({\n          file,\n          path: entry.fullPath,\n        })\n      );\n    });\n  };\n\n  getEntriesFromReader: (reader: IReader) => Promise<IWebkitEntry[]> = async (\n    reader\n  ) => {\n    let allEntries: IWebkitEntry[] = [];\n\n    let nextBatch = await this.getEntryBatch(reader);\n\n    while (nextBatch.length > 0) {\n      allEntries = allEntries.concat(nextBatch);\n      nextBatch = await this.getEntryBatch(reader);\n    }\n\n    return allEntries;\n  };\n\n  getAllFiles: (\n    entry: IWebkitEntry | null,\n    fileInfoInput: IEntryWithPath[]\n  ) => Promise<IEntryWithPath[]> = async (entry, fileInfoInput) => {\n    const reader: IReader = entry!.createReader();\n    const entries: IWebkitEntry[] = await this.getEntriesFromReader(reader);\n    if (entry!.isDirectory && entries.length === 0) {\n      fileInfoInput.push({ path: entry!.fullPath });\n    }\n    for (const entry of entries) {\n      if (entry.isDirectory) {\n        await this.getAllFiles(entry, fileInfoInput);\n      } else {\n        const file: IFileWithPath = await this.getFileFromEntry(entry);\n        fileInfoInput.push(file);\n      }\n    }\n    return fileInfoInput;\n  };\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { MultiSelectSearch } from \"@nationalarchives/tdr-components\";\nimport { NestedNavigation, InputType } from \"@nationalarchives/tdr-components\";\nimport { FolderUpload } from \"./folder-upload\";\n\nwindow.addEventListener(\"DOMContentLoaded\", (event) => {\n  /**\n   * Multi-select search.\n   */\n  const multiSelects = document.querySelectorAll(\n    \"[data-module=multi-select-search]\"\n  );\n\n  multiSelects.forEach((ms) => {\n    const multiSelectSearch = new MultiSelectSearch(ms as HTMLElement);\n    multiSelectSearch.initialise();\n  });\n\n  /**\n   * Nested Navigation\n   */\n  const tree = document.querySelector(\"[role=tree]\");\n  if (tree != null) {\n    const nestedNavigation = new NestedNavigation(tree as HTMLUListElement);\n    nestedNavigation.initialiseFormListeners(InputType.radios);\n  }\n\n  const folderUpload: HTMLElement = document.querySelector(\n    \"[data-tdr-module=folder-upload]\"\n  );\n  if (folderUpload) {\n    const fu: FolderUpload = new FolderUpload(folderUpload);\n    fu.initialise();\n  }\n});\n"],"names":[],"sourceRoot":""}