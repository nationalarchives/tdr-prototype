{% extends "layouts/main.html" %}

{% block pageTitle %}
  Error: Provide a neutral citation number
{% endblock %}

{% block header %}

  {% include "layouts/inc-header-no-view-transfer.html" %}
{% endblock %}

{% block beforeContent %}
  <a href="tell-us-more" class="govuk-back-link">Back</a>
{% endblock %}

{% block content %}

{{ govukErrorSummary({
  titleText: "There is a problem",
  errorList: [
    
    {
      text: "Enter a valid NCN, or select 'Original judgment to this update does not have an NCN'",
      href: "#update-reasons-error"
    }
  ]
}) }}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-l">
        Provide the neutral citation number (NCN) for the original judgment
      </h1>
      <div class="govuk-form-group govuk-form-group--error"">

<p id="update-reasons-error" class="govuk-error-message">
      <span class="govuk-visually-hidden">Error:</span> Enter a valid NCN, or select 'Original judgment to this update does not have an NCN'
    </p>
        <form id="neutralCitationForm" action="provide-neutral-citation-v1" method="post">
          {{ govukInput({
            label: {
              html: '<p class="govuk-body">Enter the NCN for the judgment that this update relates to:</p>',
              classes: "govuk-body",
              isPageHeading: false
            },
            id: "neutral-citation",
            name: "neutralCitation"
          }) }}





        {% set noncnHtml %}
            {{ govukInput({
              id: "no-ncnHtml",
              name: "no",
              label: {
                text: "Provide any details that would help us identify the document, such as a transfer reference  (optional):"
              }
            }) }}
          {% endset -%}

          {{ govukCheckboxes({
            name: "no-ncn",
            fieldset: {
              legend: {
                text: "Original judgment to this update does not have an NCN ",
                classes: "govuk-visually-hidden"
              }
            },
            items: [
              {
                value: "no-ncn-select",
                text: "Original judgment to this update does not have an NCN",
                conditional: {
                  html: noncnHtml
                }
              }
            ]
          }) }}
        </div>



          {{ govukDetails({
          summaryText: "Help with neutral citation numbers",
          html: '<p class="govuk-body">A neutral citation number will look like:</p>
          <ul class="govuk-list govuk-list--bullet">
            <li>[2025] EWCOP 123 (T1) </li>
            <li>[2025] EWHC 2084 (Ch)</li>
            <li>[2025] UKSC 123 </li>
          </ul>

          <p class="govuk-body">Further guidance on NCN&#39;s can be found on the <a class="govuk-link" target="_blank" href="https://nationalarchives.github.io/ds-caselaw-judiciary-guidance/ncn.html">Find Case Law website</a> (opens in a new tab).</p>'
        }) }}


        <hr class="govuk-section-break govuk-section-break--m">

        <div class="govuk-button-group">
          {{ govukButton({
            text: "Continue",
            id: "continueButton"
          }) }}
        </div>
      </form>
    </div>

    <div class="govuk-grid-column-one-third">
      <details class="govuk-details" open="" data-module="govuk-details">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">
            Transfer reference
          </span>
        </summary>
        <div class="govuk-details__text">
          MOCK-123-TDR
        </div>
      </details>
      
      <h4 class="govuk-heading-s">Problems with your transfer?</h4>
      <p class="govuk-body">Email us and include the transfer reference:
        <a href="mailto:tdr@nationalarchives.gov.uk" class="govuk-link">tdr@nationalarchives.gov.uk</a>
      </p>
    </div>
  </div>
<script>
  
  // Get references to the checkbox and input elements
const checkbox = document.querySelector('#no-ncn'); // Adjust selector as needed
const textInput = document.querySelector('#neutral-citation'); // Adjust selector as needed

// Function to handle checkbox state change
function handleCheckboxChange() {
    if (checkbox.checked) {
        // Checkbox is selected - clear input and disable it
        textInput.value = '';
        textInput.disabled = true;
        textInput.setAttribute('aria-disabled', 'true');
    } else {
        // Checkbox is deselected - enable input
        textInput.disabled = false;
        textInput.removeAttribute('aria-disabled');
        // Optionally focus the input when it becomes available
        textInput.focus();
    }
}

// Add event listener to checkbox
checkbox.addEventListener('change', handleCheckboxChange);

// Alternative version with more explicit selectors and additional features
function initConditionalInput(checkboxSelector, inputSelector) {
    const checkbox = document.querySelector(checkboxSelector);
    const textInput = document.querySelector(inputSelector);
    
    if (!checkbox || !textInput) {
        console.error('Checkbox or input element not found');
        return;
    }
    
    function toggleInput() {
        if (checkbox.checked) {
            // Clear and disable input
            textInput.value = '';
            textInput.disabled = true;
            textInput.setAttribute('aria-disabled', 'true');
            
            // Add visual styling for disabled state
            textInput.classList.add('govuk-input--disabled');
        } else {
            // Enable input
            textInput.disabled = false;
            textInput.removeAttribute('aria-disabled');
            textInput.classList.remove('govuk-input--disabled');
            
            // Focus input for better UX
            textInput.focus();
        }
    }
    
    // Set initial state based on checkbox
    toggleInput();
    
    // Add event listener
    checkbox.addEventListener('change', toggleInput);
}

// Usage example:
// initConditionalInput('#no-ncn-checkbox', '#ncn-input');
</script>
{% endblock %}
